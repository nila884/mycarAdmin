import{j as e,$ as S,S as m,r as x,R,L as P}from"./app-D9b7yil5.js";import{D as T,a as I,b as A,c as j,d as E,X as L,A as M}from"./app-layout-lUKL1h8K.js";import{C as b}from"./checkbox-Dsx9yR5o.js";import{D as d,E as k,u as K,a as O,b as U,f as v,c as z,g as B}from"./data-table-pagination-DubvfmP_.js";import{B as w}from"./app-logo-icon-BTR4zcqo.js";import{I as H}from"./input-B72JrJ1W.js";import{S as f,a as _,b as y,c as D,d as u}from"./select-p1MIQY3c.js";import{T as V,a as F,b as N,c as $,d as J,e as X}from"./table-DsQtr8xT.js";/* empty css            */import"./index-CFDuspEi.js";import"./check-BcQx4ZQH.js";const q=[{id:"select",header:({table:a})=>e.jsx(b,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:s=>a.toggleAllPageRowsSelected(!!s)}),cell:({row:a})=>e.jsx(b,{checked:a.getIsSelected(),onCheckedChange:s=>a.toggleSelected(!!s)}),enableSorting:!1,enableHiding:!1},{id:"brand",accessorKey:"version.car_model.brand.brand_name",header:({column:a})=>e.jsx(d,{column:a,title:"Brand"})},{id:"model",accessorKey:"version.car_model.model_name",header:({column:a})=>e.jsx(d,{column:a,title:"Model"})},{id:"price",accessorKey:"price.final_price",header:({column:a})=>e.jsx(d,{column:a,title:"Price"}),cell:({getValue:a})=>{const s=a();return s?e.jsx("div",{className:"text-center font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s)}):e.jsx("div",{className:"text-right",children:"N/A"})}},{id:"status",accessorKey:"spect.status",header:({column:a})=>e.jsx(d,{column:a,title:"Status"}),cell:({getValue:a})=>e.jsx("div",{className:"font-medium text-center",children:a()===1?"New":"Used"})},{id:"publication_status",accessorKey:"publication_status",header:({column:a})=>e.jsx(d,{column:a,title:"Publication Status"})},{id:"selling_status",accessorKey:"car_selling_status",header:({column:a})=>e.jsx(d,{column:a,title:"Selling Status"})},{id:"created_at",accessorKey:"created_at",header:({column:a})=>e.jsx(d,{column:a,title:"Created at"})},{id:"updated_at",accessorKey:"updated_at",header:({column:a})=>e.jsx(d,{column:a,title:"Last update"})},{id:"actions",enableSorting:!1,cell:({row:a})=>{const s=a.original,c=()=>{confirm("Are you sure you want to delete this car?")&&m.delete(route("car.destroy",s.id))};return e.jsxs(T,{children:[e.jsx(I,{asChild:!0,children:e.jsx(w,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(k,{className:"h-4 w-4"})})}),e.jsxs(A,{align:"end",children:[e.jsx(j,{asChild:!0,children:e.jsx(S,{href:route("car.show",s.id),children:"Details"})}),e.jsx(j,{asChild:!0,children:e.jsx(S,{href:route("car.edit",s.id),children:"Edit"})}),e.jsx(E,{}),e.jsx(j,{onClick:c,className:"text-red-600",children:"Delete"})]})]})}}];function G({table:a,filters:s}){const[c,p]=x.useState((s==null?void 0:s.search)??""),[l,h]=x.useState((s==null?void 0:s.publication_status)??"all"),[o,i]=x.useState((s==null?void 0:s.car_selling_status)??"all"),n=K(c,500),r=x.useRef(!0);return x.useEffect(()=>{if(r.current){r.current=!1;return}const g=new URL(window.location.href),t=Object.fromEntries(g.searchParams.entries());n?(t.search=n,t.page="1"):delete t.search,l!=="all"?(t.publication_status=l,t.page="1"):delete t.publication_status,o!=="all"?(t.car_selling_status=o,t.page="1"):delete t.car_selling_status,m.get(route("car.index"),t,{preserveState:!0,preserveScroll:!0,replace:!0})},[n,l,o]),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(H,{placeholder:"Search brand or model...",value:c,onChange:g=>p(g.target.value),className:"w-[250px]"}),e.jsxs(f,{value:l,onValueChange:h,children:[e.jsx(_,{className:"w-[180px]",children:e.jsx(y,{placeholder:"Publication status"})}),e.jsxs(D,{children:[e.jsx(u,{value:"all",children:"All statuses"}),e.jsx(u,{value:"published",children:"Published"}),e.jsx(u,{value:"pending",children:"Pending"}),e.jsx(u,{value:"archived",children:"Archived"})]})]}),e.jsxs(f,{value:o,onValueChange:i,children:[e.jsx(_,{className:"w-[180px]",children:e.jsx(y,{placeholder:"Selling status"})}),e.jsxs(D,{children:[e.jsx(u,{value:"all",children:"All "}),e.jsx(u,{value:"selling",children:"Selling"}),e.jsx(u,{value:"reserved",children:"Reserved"}),e.jsx(u,{value:"sold",children:"Sold"})]})]}),e.jsx(b,{checked:!!s.discounted,onCheckedChange:g=>{const t=new URLSearchParams(window.location.search);g?t.set("discounted","1"):t.delete("discounted"),t.set("page","1"),m.get(route("car.index"),Object.fromEntries(t),{preserveState:!0,replace:!0})}}),e.jsx("span",{className:"text-sm",children:"Discounted only"}),(c||l!=="all"||o!=="all")&&e.jsxs(w,{variant:"ghost",onClick:()=>{p(""),h("all"),i("all")},children:["Reset ",e.jsx(L,{className:"ml-2 h-4 w-4"})]}),e.jsxs("div",{children:[" ",e.jsx(O,{table:a})]})]})}function Q({columns:a,data:s,serverPagination:c,onServerPageChange:p,filters:l}){const[h,o]=R.useState(l!=null&&l.sort?[{id:l.sort,desc:l.direction==="desc"}]:[]),i=U({data:s,columns:a,getCoreRowModel:B(),manualPagination:!0,manualSorting:!0,enableMultiSort:!0,pageCount:c.pageCount,onSortingChange:n=>{const r=typeof n=="function"?n(h):n;o(r);const g=new URL(window.location.href),t=Object.fromEntries(g.searchParams.entries());r.length?(t.sort=JSON.stringify(r.map(C=>({id:C.id,desc:C.desc}))),t.page="1"):delete t.sort,m.get(route("car.index"),t,{preserveState:!0,preserveScroll:!0,replace:!0})},onPaginationChange:n=>{const r=typeof n=="function"?n({pageIndex:c.pageIndex,pageSize:c.pageSize}):n;p(r.pageIndex+1,r.pageSize)},state:{sorting:h,pagination:{pageIndex:c.pageIndex,pageSize:c.pageSize}}});return e.jsxs("div",{children:[e.jsx(G,{table:i,filters:l}),e.jsx("div",{className:"rounded-md border my-1",children:e.jsxs(V,{children:[e.jsx(F,{children:i.getHeaderGroups().map(n=>e.jsx(N,{children:n.headers.map(r=>e.jsx($,{children:r.isPlaceholder?null:v(r.column.columnDef.header,r.getContext())},r.id))},n.id))}),e.jsx(J,{children:i.getRowModel().rows.map(n=>e.jsx(N,{children:n.getVisibleCells().map(r=>e.jsx(X,{children:v(r.column.columnDef.cell,r.getContext())},r.id))},n.id))})]})}),e.jsx(z,{table:i})]})}function ie({cars:a,filters:s}){const c={pageIndex:a.current_page-1,pageSize:a.per_page,pageCount:a.last_page},p=(l,h)=>{const o=new URL(window.location.href),i=Object.fromEntries(o.searchParams.entries());i.page=String(l),i.per_page=String(h),m.get(route("car.index"),i,{preserveState:!0,preserveScroll:!0,replace:!0})};return e.jsxs(M,{children:[e.jsx(P,{title:"Cars Listings"}),e.jsxs("div",{className:"container mx-auto py-10",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(S,{href:route("car.create"),children:e.jsx(w,{children:"Add New Car"})})}),e.jsx(Q,{columns:q,data:a.data,serverPagination:c,filters:s,onServerPageChange:p})]})]})}export{ie as default};
