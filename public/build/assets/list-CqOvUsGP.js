import{r as f,m as S,j as e,S as M,L as O}from"./app-D9b7yil5.js";import{H as R}from"./heading-small-BU4M6w1f.js";import{e as B,A as F}from"./app-layout-lUKL1h8K.js";import{L as H}from"./layout-DHpDXm84.js";import{T as $,a as U,b as D,c as g,d as J,e as h}from"./table-DsQtr8xT.js";import{a as L,B as m}from"./app-logo-icon-BTR4zcqo.js";import{D as k,a as P,b as I,c as A,d as T,e as X}from"./dialog-D1i5YGBp.js";import{I as C}from"./input-B72JrJ1W.js";import{L as N}from"./label-BjwQr2PU.js";import{T as q}from"./textarea-ZtV_XNdr.js";import{I as w}from"./input-error-s3OvvhyU.js";import{u as K}from"./index-P_IZpjLU.js";import{P as Q}from"./pencil-CpbSHt1Z.js";import{P as z,T as V}from"./trash-2-D5D9zQ_C.js";import{C as W,I as Y}from"./image-plus-DSTDCbWm.js";import{S as Z}from"./ship-B710Oo-Y.js";import{G as ee}from"./globe-DcLQ2nWO.js";import{B as se}from"./building-2-CCpacj7E.js";import{M as ae}from"./map-pin-kGQjFznE.js";/* empty css            */import"./index-CFDuspEi.js";import"./check-BcQx4ZQH.js";import"./heading-DtOTHioi.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],le=L("CircleCheck",te);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ie=L("CirclePlus",re),ne=({country:s})=>{const l=!!s,[a,x]=f.useState(!1),[j,d]=f.useState((s==null?void 0:s.flags)||null),{data:c,setData:o,post:r,processing:y,errors:u,reset:b}=S({_method:l?"patch":void 0,country_name:(s==null?void 0:s.country_name)||"",code:(s==null?void 0:s.code)||"",prefix:(s==null?void 0:s.prefix)||"",currency:(s==null?void 0:s.currency)||"",import_regulation_information:(s==null?void 0:s.import_regulation_information)||"",flags:null});f.useEffect(()=>{a&&!l&&(b(),d(null))},[a]);const t=f.useCallback(i=>{if(i.length>0){const v=i[0];o("flags",v);const _=new FileReader;_.onload=()=>d(_.result),_.readAsDataURL(v)}},[o]),{getRootProps:n,getInputProps:p,isDragActive:G}=K({onDrop:t,accept:{"image/*":[".png",".jpg",".jpeg",".svg"]},maxSize:512*1024,multiple:!1}),E=i=>{i.preventDefault();const v=l?route("country.update",s.id):route("country.store");r(v,{forceFormData:!0,onSuccess:()=>x(!1)})};return e.jsxs(k,{open:a,onOpenChange:x,children:[e.jsx(P,{asChild:!0,children:e.jsx(m,{variant:l?"outline":"default",size:l?"icon":"default",children:l?e.jsx(Q,{className:"h-4 w-4"}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Add Country"]})})}),e.jsxs(I,{className:"sm:max-w-[425px]",children:[e.jsxs(A,{children:[e.jsx(T,{children:l?"Edit Country":"Register New Country"}),e.jsx(X,{children:"Enter country details and upload a flag icon."})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Country Name"}),e.jsx(C,{value:c.country_name,onChange:i=>o("country_name",i.target.value),placeholder:"e.g. Japan"}),e.jsx(w,{message:u.country_name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"ISO Code"}),e.jsx(C,{value:c.code,onChange:i=>o("code",i.target.value),placeholder:"JPN"}),e.jsx(w,{message:u.code})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Dial Prefix"}),e.jsx(C,{value:c.prefix,onChange:i=>o("prefix",i.target.value),placeholder:"+81"}),e.jsx(w,{message:u.prefix})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Regulation Information"}),e.jsx(q,{value:c.import_regulation_information,onChange:i=>o("import_regulation_information",i.target.value),placeholder:"Import rules...",className:"h-20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Flag Image"}),e.jsxs("div",{...n(),className:`border-2 border-dashed rounded-lg p-4 text-center cursor-pointer transition-colors ${G?"border-primary bg-slate-50":"border-slate-200"}`,children:[e.jsx("input",{...p()}),j?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:j,className:"h-12 w-auto rounded shadow-sm",alt:"Preview"}),e.jsx(m,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full",onClick:i=>{i.stopPropagation(),d(null),o("flags",null)},children:e.jsx(W,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"flex flex-col items-center text-slate-400",children:[e.jsx(Y,{className:"h-8 w-8 mb-1"}),e.jsx("span",{className:"text-xs",children:"Click or drag flag"})]})]}),e.jsx(w,{message:u.flags})]}),e.jsx(m,{type:"submit",className:"w-full",disabled:y,children:l?"Update Changes":"Create Country"})]})]})]})},oe=({country:s,ports:l})=>{var b;const[a,x]=f.useState(!1),j=((b=s.gateway_ports)==null?void 0:b.map(t=>t.id))||[],{data:d,setData:c,post:o,processing:r}=S({port_ids:j});f.useEffect(()=>{var t;a&&c("port_ids",((t=s.gateway_ports)==null?void 0:t.map(n=>n.id))||[])},[a,s]);const y=t=>{const n=[...d.port_ids],p=n.indexOf(t);p>-1?n.splice(p,1):n.push(t),c("port_ids",n)},u=t=>{t.preventDefault(),o(route("country.gateways.update",s.id),{onSuccess:()=>x(!1)})};return e.jsxs(k,{open:a,onOpenChange:x,children:[e.jsx(P,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",className:"gap-2 border-dashed hover:border-blue-400 hover:bg-blue-50",children:[e.jsx(Z,{className:"w-4 h-4 text-blue-600"})," Gateways"]})}),e.jsxs(I,{className:"sm:max-w-[500px]",children:[e.jsxs(A,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-slate-400"}),"Gateways for ",s.country_name]}),e.jsx(B,{className:" tex-sm",children:"Setup Country ports Gateway."})]}),e.jsxs("form",{onSubmit:u,className:"space-y-4 pt-4",children:[e.jsx("div",{className:"grid gap-2 max-h-[350px] overflow-y-auto pr-2 custom-scrollbar",children:l.map(t=>{var p;const n=d.port_ids.includes(t.id);return e.jsxs("div",{onClick:()=>y(t.id),className:`group flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all duration-200 ${n?"bg-blue-50 border-blue-500 shadow-sm":"border-slate-200 hover:border-slate-400 hover:bg-slate-50"}`,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm font-semibold ${n?"text-blue-700":"text-slate-700"}`,children:t.name}),e.jsx("span",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:(p=t.country)==null?void 0:p.country_name})]}),n?e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Active Gateway"}),e.jsx(le,{className:"w-5 h-5 fill-blue-600 text-white"})]}):e.jsx(ie,{className:"w-5 h-5 text-slate-300 group-hover:text-slate-500"})]},t.id)})}),e.jsx("div",{className:"pt-4 border-t flex items-center",children:e.jsx(m,{type:"submit",className:"w-ful",disabled:r,children:r?"Saving Assignments...":"Update Gateway Network"})})]})]})]})},ce=({country:s})=>{const{data:l,setData:a,post:x,processing:j,reset:d}=S({name:"",country_id:s.id,is_hub:!1}),c=r=>{r.preventDefault(),x(route("cities.store"),{onSuccess:()=>d("name")})},o=r=>{confirm("Are you sure you want to remove this city?")&&M.delete(route("cities.destroy",r))};return e.jsxs(k,{children:[e.jsx(P,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-emerald-600"})," Cities"]})}),e.jsxs(I,{className:"sm:max-w-[425px]",children:[e.jsx(A,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-slate-400"}),"Cities in ",s.country_name]})}),e.jsxs("form",{onSubmit:c,className:"flex gap-2 pt-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(C,{placeholder:"Add city name...",value:l.name,onChange:r=>a("name",r.target.value)})}),e.jsx(m,{type:"submit",disabled:j||!l.name,children:e.jsx(z,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mt-6 space-y-2 max-h-[300px] overflow-y-auto pr-2",children:s.cities&&s.cities.length>0?s.cities.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-slate-50/50 group",children:[e.jsx("span",{className:"text-sm font-medium",children:r.name}),e.jsx(m,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>o(r.id),children:e.jsx(V,{className:"w-4 h-4"})})]},r.id)):e.jsx("p",{className:"text-center py-4 text-slate-400 text-sm",children:"No cities registered."})})]})]})};function Le({countries:s,ports:l}){return e.jsxs(F,{children:[e.jsx(O,{title:"Country Settings"}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(R,{title:"Country Management"}),e.jsx(ne,{})]}),e.jsx("div",{className:"rounded-md border bg-white overflow-hidden",children:e.jsxs($,{children:[e.jsx(U,{className:"bg-slate-50",children:e.jsxs(D,{children:[e.jsx(g,{className:"w-[80px]",children:"Flag"}),e.jsx(g,{children:"Country Name"}),e.jsx(g,{children:"ISO Code"}),e.jsx(g,{children:"Currency"}),e.jsx(g,{children:"Created At"}),e.jsx(g,{className:"text-right px-6",children:"Actions"})]})}),e.jsx(J,{children:s.data.length>0?s.data.map(a=>e.jsxs(D,{className:"hover:bg-slate-50/50",children:[e.jsx(h,{children:a.flags?e.jsx("img",{src:a.flags,alt:"flag",className:"w-10 h-7 object-cover rounded shadow-sm border"}):e.jsx("div",{className:"w-10 h-7 bg-slate-100 rounded flex items-center justify-center text-[10px] text-slate-400",children:"N/A"})}),e.jsx(h,{className:"font-semibold text-slate-700",children:a.country_name}),e.jsx(h,{className:"text-slate-500 font-mono text-xs",children:a.code}),e.jsx(h,{children:a.currency}),e.jsx(h,{className:"text-slate-400 text-xs",children:a.created_at}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(ce,{country:a}),e.jsx(oe,{country:a,ports:l})]})})]},a.id)):e.jsx(D,{children:e.jsx(h,{colSpan:6,className:"h-24 text-center text-slate-500",children:"No countries found."})})})]})})]})]})}export{Le as default};
